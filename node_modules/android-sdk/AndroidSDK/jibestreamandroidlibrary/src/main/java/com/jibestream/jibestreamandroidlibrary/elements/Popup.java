package com.jibestream.jibestreamandroidlibrary.elements;

import android.graphics.Path;
import android.graphics.RectF;

import com.jibestream.jibestreamandroidlibrary.shapes.IShape;
import com.jibestream.jibestreamandroidlibrary.shapes.JPath;
import com.jibestream.jibestreamandroidlibrary.shapes.MultiShape;
import com.jibestream.jibestreamandroidlibrary.shapes.TextStaticLayout;

/**
 * Created by emmanuel on 15-09-03.
 */
public class Popup extends ElementMap {

private String titleString = "Title";
private String bodyString = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut eleifend pharetra nibh, eget vehicula nisi maximus et.";
private String subTitleString = "SubTitle";
private final TextStaticLayout titleStaticLayout = new TextStaticLayout();
private final TextStaticLayout subTitleStaticLayout = new TextStaticLayout();
private final TextStaticLayout bodyStaticLayout = new TextStaticLayout();

private int width = 400;
private JPath jPath;
private Path path;
private MultiShape multiShape;

public Popup() {
  setBoundingBoxVisible(true);
  jPath = new JPath();
  path = new Path();
  jPath.setPath(path);
  multiShape = new MultiShape();
  multiShape.addShape(jPath);
  multiShape.addShape(titleStaticLayout);
  multiShape.addShape(subTitleStaticLayout);
  multiShape.addShape(bodyStaticLayout);
  setShape(multiShape);
  calc();
}

private void calc() {
  titleStaticLayout.setTextString(titleString);
  final int padding = 20;
  titleStaticLayout.setWidth(width - padding * 2);
  titleStaticLayout.setOffsetX(padding);

  subTitleStaticLayout.setTextString(subTitleString);
  subTitleStaticLayout.setWidth(width - padding * 2);
  subTitleStaticLayout.setOffsetX(padding);

  bodyStaticLayout.setTextString(bodyString);
  bodyStaticLayout.setWidth(width - padding * 2);
  bodyStaticLayout.setOffsetX(padding);


  float accumY = padding;
  titleStaticLayout.setOffsetY(accumY);
  accumY += titleStaticLayout.getHeight();
  accumY += 5;
  subTitleStaticLayout.setOffsetY(accumY);
  accumY += subTitleStaticLayout.getHeight();
  accumY += 5;
  bodyStaticLayout.setOffsetY(accumY);
  accumY += bodyStaticLayout.getHeight();
  accumY += padding;

  path.reset();
  path.moveTo(0, 0);
  path.lineTo(width, 0);
  path.lineTo(width, accumY);
  float halfW = width * 0.5f;
  path.lineTo(halfW + 50, accumY);
  path.lineTo(200, accumY + 50);
  path.lineTo(halfW - 50, accumY);
  path.lineTo(0, accumY);
  path.close();
  jPath.setPath(path);


  multiShape.setOffsetX(-halfW);
  multiShape.setOffsetY(-accumY - 50f);
}

public String getTitleString() {
  return titleString;
}

public void setTitleString(String titleString) {
  this.titleString = titleString;
  calc();
}

public String getSubTitleString() {
  return subTitleString;
}

public void setSubTitleString(String subTitleString) {
  this.subTitleString = subTitleString;
  calc();
}

public String getBodyString() {
  return bodyString;
}

public void setBodyString(String bodyString) {
  this.bodyString = bodyString;
  calc();
}


public TextStaticLayout getBodyStaticLayout() {
  return bodyStaticLayout;
}


public TextStaticLayout getTitleStaticLayout() {
  return titleStaticLayout;
}


public TextStaticLayout getSubTitleStaticLayout() {
  return subTitleStaticLayout;
}

public int getWidth() {
  return width;
}

public void setWidth(int width) {
  this.width = width;
  calc();
}
}
